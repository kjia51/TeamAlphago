<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.alpha.mapper.TeacherMapper">

<!-- 콘텐츠  -->
	<!-- 조회  -->
	<select id="getContentList" resultType="com.alpha.vo.ContentVO">

		select *
		from ( select rownum rn, t.*
        from ( select *
            from content
            order by c_id desc) t)
            where rn between #{startNo} and #{endNo}
	</select>
	
	<!-- 콘텐츠 총 갯수 -->
	<select id="totalCnt" resultType="int">
	select count(*) from content
	</select>	
	
	<!-- c_id로 콘텐츠 상세 내용 가져오기 -->
	<select id="getContentDetail" resultType="com.alpha.vo.ContentVO">
	select * from content where c_id = #{c_id}
	</select>
	
	<!-- 결제 시 구독내역에 인서트 -->
	<insert id="insertPayAction">
   	insert into subscribe (SUB_ID, SUB_C_ID, T_M_ID, SUB_NAME, SUB_DATE, SUB_PRICE,
                  SUB_ABLE, SUB_CURRENT)
             values (#{sub_id}, #{sub_c_id}, #{t_m_id}, #{sub_name}, #{sub_date}, #{sub_price}
             , #{sub_able}, #{sub_current})
   </insert>
	
	<!-- 나의 구독내역 리스트 -->
	<select id="mySubList" resultType="com.alpha.vo.SubscribeVO">
	select * from subscribe where t_m_id = #{t_m_id}
	</select>
		
	<!-- 취소 시 환불&구독내역에서 삭제 -->
	<delete id="cancelPay">
		delete subscribe where sub_id=#{sub_id}
	</delete>
	
<!-- 그룹  -->
	<!-- t_m_id로  가져오기 -->
	<select id="getmyGroupList" resultType="com.alpha.vo.GroupVO">
	select * from groups where t_m_id = #{t_m_id}
	</select>
	
	<!-- 그룹 등록  -->
	<insert id="insertGroups">
	insert into groups (g_id, t_m_id, g_c_id, g_cnt, g_start, g_end) values 
		('G' || LPAD(SEQ_GROUPS.NEXTVAL, 4, '0'), #{t_m_id}, #{g_c_id}, #{g_cnt}
		, to_date(#{g_start},'RR/MM/DD'), to_date(to_date(#{g_start})+90,'RR/MM/DD'));
	</insert>
	
	<!-- 해당 구독 정보 가져오기 / sub_id-->
	<select id="getSubOne"  resultType="com.alpha.vo.SubscribeVO">
	select * from subscribe where sub_id = #{sub_id}
	</select>

</mapper>